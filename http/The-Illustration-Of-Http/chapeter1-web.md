# 了解`web`及网络基础

## 网络基础 `TCP/IP`
通常使用的网络是在`TCP/IP`协议族的基础上运作的，`HTTP`属于其中的一个子集

### `TCP/IP`协议族
计算机与网络要互相通信，那么双方就必须基于相同的方法。比如，如何探测到通信目标、由哪一边先发起通信、使用哪种语言进行通信，怎样结束通信等规则都需要事先确定。不同的硬件、操作系统之间的通信，所有的这一切都需要规则，这种规则就被称为协议

`TCP/IP`是互联网相关的各类协议族的总称

### `TCP/IP`的分层管理
`TCP/IP`协议族里最重要的一点就是分层。`TCP/IP`协议族按层次分别分为以下几层：应用层，传输层，网络层，数据链路层

- 应用层：应用层决定了向用户提供应用服务时通信的活动。`TCP/IP`协议族内预存了各类通用的应用服务，比如，`FTP`(`File Transfer Protocol`文件传输协议)、`DNS`(`Domain Name System`域名系统)、`HTTP`等等

- 传输层：传输层对上层应用层提供处于网络连接中的两台计算机之间的数据传输。在传输层有两个性质不同的协议：`TCP`(`Transmission Control Protocol`传输控制协议)和`UDP`(`User Data Protocol`用户数据包协议)

- 网络层：网络层用来处理在网络上流动的数据包。数据包是网络传输的最小数据单位。该层规定了通过怎样的路径到达对方计算机，并把数据包传送给对方。 与对方计算机之间通过多台计算机或网络设备进行传输时，网络层所起的作用就是在众多的选项内选择一条传输路线

- 链路层：用来处理链接网络的硬件部分。包括控制操作系统、硬件的设备驱动，网络适配器以及光纤等物理可见部分

### `TCP/IP`通信传输流
利用`TCP/IP`协议族进行网络通信时，会通过分层顺序与对方进行通信。发送端从应用层向下走，接收端从链路层往上走

用一个`HTTP`举例来说明，首先发送端的客户端在应用层发出一个`web`的`http`请求，接着，在传输层，将`http`请求报文进行切割，并为各个报文添加序号以及端口号后转发给网络层。在网络层，增加通信目的地的`MAC`地址后转发给链路层。在链路层，增加以太网首部后向物理层发送通信报文

接收端的服务器在链路层接收到数据，按序往上层发送，一直传输到应用层。

发送端在层与层之间传输数据时，每经过一层就会被打上每一层所属的首部信息。相反，接收端在层与层之间传输数据时，每经过一层会把对应的首部丢失

## 与`HTTP`关系密切的协议：`IP`、`TCP`和`DNS`

### 负责传输的`IP`协议
`IP`(`Internet Protocol`网际协议)位于网络层。`IP`协议的作用是把各种数据包传送给对象。为了保证确实传送到对方哪里，则需要满足各种条件。其中两个重要的条件就是`IP`地址和`MAC`地址(`Media Access Control Address`)

`IP`地址指明了节点被分配到的地址，`MAC`地址是指网卡所属的固定地址。`IP`地址可以和`MAC`地址进行配对。`IP`地址可变，但`MAC`地址不变

##### 使用`ARP`协议凭借`MAC`地址进行通信
`IP`间的通信依赖`MAC`地址。在网络上，通信的双方在同一个局域网内的情况很少见，通常是经过多台计算机和网络设备中转才能连接到对方。而在中转时，需要知道其`MAC`地址来搜索目标。这时，就需要`ARP`来将`IP`地址转换为`MAC`地址

### 确保可靠性的`TCP`协议
`TCP`位于传输层，提供可靠的字节流服务。所谓的字节流服务是指，为了方便传输，将大块数据分割成以报文段为单位的数据包进行管理。而可靠的传输服务是指，能够把数据准确可靠的传输给对方。

##### 确保数据能够达到目标
为了准确无误地将数据送达目标，`TCP`采用了三次握手策略。用`TCP`协议把数据包送出去之后，`TCP`不会对传送后的情况置之不理，它一定会向对方确认是否成功发送。握手过程中使用了`TCP`标志--`SYN`(`synchronize`)和`ACK`(`acknowledgement`)

发送端首先发送一个带有`SYN`标志的数据包给对方。接收端接收到之后，会回传一个带有`SYN/ACK`标志的数据包以示传达确认消息。最后，发送端再回传一个带`ACK`的数据包，代表“握手”结束

若在握手过程中的某个阶段中断，那么`TCP`协议会再次以相同的顺序发送相同的数据包