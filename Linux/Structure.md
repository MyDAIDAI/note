# 存储结构与磁盘划分

## 从`/`开始
`Linux`系统中的一切文件都是从根`/`目录开始的，并按照文件系统层次化标准(`FHS`)采用树形结构来存放文件，以及定义常见目录的用途。

`Linux`系统中的文件和目录名称是严格区分大小写的

`Linux`系统中的文件存储结构：
- 根目录`/`
  - `/root`: 系统管理员目录
  - `/bin`: 存放单用户模式下可以操作的命令
  - `/boot`: 开机所需文件（内核、开机菜单以及所需配置文件等）
  - `/dev`: 以文件形式存放的设备与接口
  - `/etc`: 配置文件
  - `/home`: 用户目录
  - `/var`: 主要存放经常变化的文件，如日志
  - `/lib`: 开机时需要用到的函数库，以及`/bin`与`/sbin`中的命令要调用的函数
  - `/usr`
    - `/usr/local`: 用户自行安装的软件
    - `/usr/sbin`: 开机时会使用到的软件/命令/脚本
    - `/usr/share`: 帮助与说明文件，也可放置共享文件
  - `/media`: 用于挂载设备文件的目录
  - `/tmp`: 任何用户共享的临时目录
  - `/sbin`: 开机过程中需要的命令
  - `/opt`: 第三方软件
  - `/srv`: 一些网络服务的数据文件目录
  - `/proc`: 虚拟文件系统，例如系统内核、进程、外部设备及网络状态等
  - `/lost+found`: 当文件系统发生错误时，将一些丢失的文件片段存放在这里

路径：如何定位到某个文件
- 绝对路径：从根目录`/`开始的文件或目录名称
- 相对路径：相当于当前路径

## 挂载硬件设备

### `mount`命令
`mount`命令用于挂载文件系统，格式为`mount 文件系统 挂载目录`

只需要使用`mount`命令把硬盘设备或者分区与一个目录进行关联，这样就能在这个目录中看到硬件设备中的数据了

`-a`: 挂载所有在`/ect/fstab`中定义的文件系统
`-t`: 指定文件系统的类型

```
mount /dev/sdb2 /backup
```
虽然按照上面的方法执行`mount`命令之后就能立即使用文件系统，但系统在重启之后挂载就会失效，也就是说需要每次开机后都手动挂载一下

如果想要硬件设备和目录永久地进行关联，就必须把挂载信息按照指定的填写格式“设备文件 挂载目录 格式类型 权限选项 是否备份 是否自检”写入到`/etc/fstab`文件中
- 设备文件：一般为设备的路径加设备名称，也可以写为唯一识别码
- 挂载目录：指定要挂载到的目录，需在挂载前创建好
- 格式类型：执行文件系统的格式，如`Ext3`、`Ext4`、`XFS`等
- 权限选项：若设置为`default`，则默认权限为:`rw, suid, dev, exec, auto, nouser, async`
- 是否备份：若为`1`则开机后使用`dump`进行磁盘备份，为`0`则不备份
- 是否自检：若为`1`则开机后自动进行磁盘自检，为`0`则不自检

### `umount`命令
`umount`命令用于撤销已经挂载的设备文件，格式为`umount [挂载点/设备文件]`

挂载文件系统的目的是为了使用硬件资源，而卸载文件系统意味着不再使用硬件的设备资源 `umount /dev/sdb2`

## 添加硬盘设备

### `fdish`命令
`fdisk` -- `manipulate disk partition table`, 管理磁盘分区，格式为`fdisk [磁盘名称]`

## 软硬方式链接
在`window`中，快捷方式就是指向原始文件的一个链接文件，可以让用户从不同的位置来访问原始文件；原始文件一旦被删除或剪切到其他地方后，会导致链接失败

在`Linux`系统中存在硬链接和软链接两种文件

- 硬链接(`hard link`): 可以理解为指向原始文件的指针，系统不为它分配独立的`inode`和文件。所以，**硬链接文件和原始文件其实是同一个文件**，只是名字不同。每添加一个硬链接，该文件的`inode`连接数就会增加1，只有当该文件的`inode`连接数为0时，才算彻底将其删除。也就是说，由于硬链接实际上是指向原文件`inode`的指针，即使原始文件被删除，依然可以通过硬链接文件来访问。需要注意的是，由于技术的局限性，不能跨分区对目录文件进行链接

- 软链接(符号链接`[symbolic link]`): 仅仅包含所链接文件的路径名，因此能链接目录文件，也可以跨域文件系统进行链接。但是，当原始文件本删除后，链接文件也会失效，这与`window`中的快捷方式相似

### `ln`
`ln` -- `make links between files`, 用于创建链接文件，格式为`ln [选项] 目标`
参数：
- `-s`: 创建“符号链接”（默认创建硬链接）
- `-f`: 强制创建文件或者目录的链接
- `-i`: 覆盖前先询问
- `-v`: 显示创建链接的过程

```
[root@izm5e3ysu09m3fsttcfydjz ~]# echo "welcome to daidai de website" > readme.txt
[root@izm5e3ysu09m3fsttcfydjz ~]# cat readme.txt
welcome to daidai de website
[root@izm5e3ysu09m3fsttcfydjz ~]# ln -s readme.txt readit.txt // 软链接文件

[root@izm5e3ysu09m3fsttcfydjz ~]# ls -l readit.txt
lrwxrwxrwx 1 root root 10 6月  17 17:44 readit.txt -> readme.txt // 软连接文件第一个为 l

[root@izm5e3ysu09m3fsttcfydjz ~]# ln readme.txt readit1.txt
[root@izm5e3ysu09m3fsttcfydjz ~]# ls -l readit1.txt
-rw-r--r-- 1 root root 18 6月  17 17:47 readit1.txt // 硬链接文件与原始文件为同一个文件
```