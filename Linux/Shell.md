# 编写`shell`脚本
- 交互式：用户每输入一条命令就立即执行
- 批处理：由用户事先编好一个完整的脚本，一次性执行

## 接受参数
`shell`内设了用于接收参数的变量，变量之间可以使用空格间隔
- `$0`：当前脚本程序的名称
- `$#`：总共有几个参数
- `$*`：对应的所有位置的参数
- `$?`：显示上一次命令的执行返回值
- `$N`：分别对应着第`N`个位置的参数

## 判断用户参数
`shell`脚本中的条件测试语法可以判断表达式是否成立，若条件成立就返回数字`0`，否则便返回其他随机数值

格式: `[ 条件表达式 ]`（左右两边均有一个空格）

### 条件测试语句
- 文件测试语句：指定条件来判断文件是否存在或者权限是否满足等情况的运算符
  - `-d`：测试文件是否为目录类型
  - `-e`：测试文件是否存在
  - `-f`：判断是否为一般文件
  - `-r`：测试当前用户是否有读取权限
  - `-w`：测试当前用户是否有写入权限
  - `-x`：测试当前用户是否有执行权限
- 逻辑测试语句
  - `&&`：与，表示当前的命令执行成功之后才会执行后面的命令
  - `||`：或，表示当前的命令执行失败之后才会执行它后面的命令
  - `!`：非，表示把条件测试中的判断结果取相反值
  ```
  [ ! $USER = root ] && echo 'other user' || echo 'root'
  // root:不满足 && 则会执行后面的 ||
  [ ! $USER = root ] || echo 'root' && echo 'other user'
  // root other user: 执行了 || 之后返回的值为 0, 所以会继续向下执行 || 的操作
  ```
- 整数值比较语句：仅对数字的操作，不能将数字与字符串、文件等内容一起操作，而且不能使用日常生活中的等号、大于号、小于号等来判断（与输入输出重定向命令符冲突）
  - `-eq`：是否等于
  - `-ne`：是否不等于
  - `-gt`：是否大于
  - `-lt`：是否小于
  - `-le`：是否等于或小于
  - `-ge`：是否大于或等于
  ```
  FreeMem=`free -m | grep Mem: | awk '{print $3}'`
  [ $FreeMem -lt 1024 ] && echo 'Insufficient Memory'
  TestFreeMen=`free -m | grep Mem: | awk '{print $4}'` && [ $TestFreeMen -lt 1024 ] && echo 'insufficient memory'
  ```
- 字符串比较语句：判断测试字符串是否为空值，或者两个字符串是否相等。经常用来判断某个变量是否未被定义
  - `=`：比较字符串是否相同
  - `!=`：比较字符串内容是否不同
  - `-z`：判断字符串内容是否为空

### 流程控制语句
- `if`条件测试语句
  - 单分支结构 -- `if then fi`
  - 双分支结构 -- `if then else fi`
  - 多分支结构 -- `if then elif then else fi`

- `for`条件循环语句
```
for 变量名 in 取值列表
do
  命令序列
done
```

- `while`条件循环语句
```
while 条件测试操作
do
  命令序列
done
```

注：`/dev/null`是一个被称为`Linux`黑洞的文件，把输出信息重定向到这个文件等同于删除数据（类似于没有回收功能的垃圾箱），可以让用户的屏幕窗口保持简洁

- `case`条件测试与
```
case 变量值 in
模式1)
  命令序列1
  ;;
模式2)
  命令序列2
  ;;
*)
  默认命令序列
esac
```

## 计划任务服务程序
计划任务分为一次性计划任务以及长期性计划任务
- 一次性计划任务只执行一次，一般用于满足临时的工作需求，可以使用`at`命令实现 -- `at 时间`
- 长期性计划任务，周期性地有规律地执行某些任务 -- `crond`